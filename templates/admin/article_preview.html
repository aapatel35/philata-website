{% extends "admin/base_admin.html" %}

{% block title %}Preview: {{ article.title }} - Philata CMS{% endblock %}

{% block extra_css %}
<style>
    .preview-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        overflow: hidden;
    }
    .preview-header {
        padding: 20px;
        background: #f8f9fa;
        border-bottom: 1px solid #e9ecef;
    }
    .preview-content {
        padding: 40px;
        max-width: 800px;
        margin: 0 auto;
    }
    .preview-content h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 20px;
        color: #1e3a5f;
    }
    .preview-meta {
        display: flex;
        gap: 20px;
        margin-bottom: 30px;
        color: #6c757d;
        font-size: 14px;
    }
    .preview-image {
        width: 100%;
        max-height: 400px;
        object-fit: cover;
        border-radius: 8px;
        margin-bottom: 30px;
    }
    .preview-body {
        font-size: 18px;
        line-height: 1.8;
        color: #333;
    }
    .preview-body h2 {
        font-size: 1.75rem;
        margin-top: 40px;
        margin-bottom: 20px;
        color: #1e3a5f;
    }
    .preview-body h3 {
        font-size: 1.5rem;
        margin-top: 30px;
        margin-bottom: 15px;
        color: #1e3a5f;
    }
    .preview-body p {
        margin-bottom: 20px;
    }
    .preview-body ul, .preview-body ol {
        margin-bottom: 20px;
        padding-left: 30px;
    }
    .preview-body li {
        margin-bottom: 10px;
    }
    .preview-body blockquote {
        border-left: 4px solid #1e3a5f;
        padding-left: 20px;
        margin: 30px 0;
        font-style: italic;
        color: #555;
    }
    .preview-body a {
        color: #1e3a5f;
        text-decoration: underline;
    }
    .preview-body img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin: 20px 0;
    }
    .preview-body table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
    }
    .preview-body th, .preview-body td {
        border: 1px solid #e9ecef;
        padding: 12px;
        text-align: left;
    }
    .preview-body th {
        background: #f8f9fa;
        font-weight: 600;
    }
    .status-badge {
        font-size: 12px;
        padding: 4px 12px;
        border-radius: 20px;
    }
</style>
{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item"><a href="{{ url_for('admin_articles') }}">Articles</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('admin_article_edit', slug=article.slug) }}">Edit</a></li>
        <li class="breadcrumb-item active">Preview</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <!-- Preview Header -->
            <div class="preview-container mb-4">
                <div class="preview-header d-flex justify-content-between align-items-center">
                    <div>
                        <h5 class="mb-1">Article Preview</h5>
                        <small class="text-muted">This is how your article will appear on the website</small>
                    </div>
                    <div class="d-flex gap-2">
                        {% if article.status == 'draft' %}
                        <span class="badge bg-warning text-dark status-badge">Draft</span>
                        {% else %}
                        <span class="badge bg-success status-badge">Published</span>
                        {% endif %}
                        <a href="{{ url_for('admin_article_edit', slug=article.slug) }}" class="btn btn-sm btn-primary">
                            <i class="fas fa-edit me-1"></i>Edit
                        </a>
                        {% if article.status == 'published' %}
                        <a href="/articles/{{ article.slug }}" target="_blank" class="btn btn-sm btn-outline-secondary">
                            <i class="fas fa-external-link-alt me-1"></i>View Live
                        </a>
                        {% endif %}
                    </div>
                </div>

                <!-- Article Preview -->
                <div class="preview-content">
                    <h1>{{ article.title }}</h1>

                    <div class="preview-meta">
                        <span>
                            <i class="fas fa-folder me-1"></i>
                            {{ (article.category or 'Uncategorized')|replace('_', ' ')|title }}
                        </span>
                        <span>
                            <i class="fas fa-calendar me-1"></i>
                            {{ article.created_at[:10] if article.created_at else 'Unknown date' }}
                        </span>
                        {% if article.source %}
                        <span>
                            <i class="fas fa-link me-1"></i>
                            {{ article.source }}
                        </span>
                        {% endif %}
                    </div>

                    {% if article.image_url %}
                    <img src="{{ article.image_url }}" alt="{{ article.title }}" class="preview-image">
                    {% endif %}

                    {% if article.summary %}
                    <p class="lead text-muted mb-4">{{ article.summary }}</p>
                    {% endif %}

                    <div class="preview-body">
                        {{ article.content|safe }}
                    </div>
                </div>
            </div>

            <!-- SEO Preview -->
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-search me-2"></i>Search Engine Preview</h6>
                </div>
                <div class="card-body">
                    <div class="seo-preview" style="max-width: 600px;">
                        <div style="color: #1a0dab; font-size: 18px; font-family: Arial, sans-serif;">
                            {{ article.title[:60] }}{% if article.title|length > 60 %}...{% endif %}
                        </div>
                        <div style="color: #006621; font-size: 14px; font-family: Arial, sans-serif;">
                            philata.com/articles/{{ article.slug }}
                        </div>
                        <div style="color: #545454; font-size: 13px; font-family: Arial, sans-serif; line-height: 1.4;">
                            {{ (article.meta_description or article.summary or '')[:160] }}{% if (article.meta_description or article.summary or '')|length > 160 %}...{% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
